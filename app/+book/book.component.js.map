{"version":3,"file":"book.component.js","sourceRoot":"","sources":["book.component.ts"],"names":[],"mappings":";;;;;;;;;;AAAA,qBAAkC,eAAe,CAAC,CAAA;AAClD,uBAAgD,iBAAiB,CAAC,CAAA;AAElE,qBAAgD,SAAS,CAAC,CAAA;AAC1D,qBAAkC,SAAS,CAAC,CAAA;AAQ5C;IAME,uBACU,WAAuB,EACvB,WAAuB;QADvB,gBAAW,GAAX,WAAW,CAAY;QACvB,gBAAW,GAAX,WAAW,CAAY;IAC7B,CAAC;IAEL,gCAAQ,GAAR;QAAA,iBAEC;QADC,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,SAAS,CAAC,UAAA,IAAI,IAAI,OAAA,KAAI,CAAC,IAAI,GAAG,IAAI,EAAhB,CAAgB,CAAC,CAAC;IAC5D,CAAC;IAED,wCAAgB,GAAhB,UAAiB,IAAkB;QAAnC,iBAUC;QATC,IAAI,EAAE,GAAG,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC;QACjC,IAAI,CAAC,WAAW,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC,SAAS,CAAC,UAAA,IAAI;YACzC,OAAO,CAAC,GAAG,CAAC,cAAc,CAAC,CAAC;YAC5B,KAAI,CAAC,IAAI,GAAG,IAAI,CAAC;YACjB,EAAE,CAAC,CAAC,KAAI,CAAC,IAAI,KAAK,IAAI,CAAC;gBACrB,KAAI,CAAC,IAAI,CAAC,EAAE,GAAG,EAAE,CAAC;YACpB,OAAO,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC;YACzB,IAAI,KAAK,IAAI,GAAG,KAAI,CAAC,KAAK,GAAG,IAAI,GAAG,KAAI,CAAC,WAAW,CAAC,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,SAAS,CAAC,UAAA,IAAI,IAAI,OAAA,KAAI,CAAC,KAAK,GAAG,IAAI,EAAjB,CAAiB,CAAC,CAAC;QAChH,CAAC,CAAC,CAAC;IACL,CAAC;IAED,kCAAU,GAAV,UAAW,IAAS;QAClB,OAAO,CAAC,GAAG,CAAC,aAAa,CAAC,CAAC;QAC3B,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC;YACR,MAAM,CAAC,EAAE,CAAC;QACZ,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC;YAChB,MAAM,CAAC,iBAAiB,CAAC;QAC3B,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,UAAC,IAAI,EAAE,OAAO,IAAK,OAAA,IAAI,GAAG,IAAI,GAAG,OAAO,EAArB,CAAqB,CAAC,CAAC;IACvE,CAAC;IAEO,wCAAgB,GAAxB,UAAyB,IAAS;QAChC,OAAO,CAAC,GAAG,CAAC,YAAY,CAAC,CAAA;QACzB,IAAI,OAAO,GAAgB;YACvB,MAAM,EAAE,IAAI,CAAC,IAAI,CAAC,EAAE;YACpB,OAAO,EAAE,IAAI,CAAC,KAAK,CAAC,EAAE;YACtB,WAAW,EAAE,IAAI,CAAC,IAAI,CAAC,EAAE;YACzB,MAAM,EAAE,KAAK;SACd,CAAC;QACJ,IAAI,CAAC,WAAW,CAAC,eAAe,CAAC,OAAO,CAAC,CAAC;QAC1C,KAAK,CAAC,+BAA+B,GAAG,IAAI,CAAC,KAAK,CAAC,CAAC;IACtD,CAAC;IApDH;QAAC,gBAAS,CAAC;YACT,QAAQ,EAAE,MAAM,CAAC,EAAE;YACnB,QAAQ,EAAE,UAAU;YACpB,WAAW,EAAE,qBAAqB;YAClC,UAAU,EAAE,CAAC,0BAAiB,CAAC;SAChC,CAAC;;qBAAA;IAiDF,oBAAC;AAAD,CAAC,AAhDD,IAgDC;AAhDY,qBAAa,gBAgDzB,CAAA","sourcesContent":["import { Component, OnInit } from '@angular/core';\nimport { RouteSegment, ROUTER_DIRECTIVES } from '@angular/router';\n\nimport { Book, BookService, TradeRequest } from '../book';\nimport { User, UserService } from '../user';\n\n@Component({\n  moduleId: module.id,\n  selector: 'app-book',\n  templateUrl: 'book.component.html',\n  directives: [ROUTER_DIRECTIVES]\n})\nexport class BookComponent implements OnInit {\n\n  private user:User;\n  private book:Book\n  private owner:User;\n  \n  constructor(\n    private bookService:BookService, \n    private userService:UserService\n  ) { }\n\n  ngOnInit() {\n    this.userService.user.subscribe(user => this.user = user);\n  }\n  \n  routerOnActivate(curr: RouteSegment): void {\n    let id = curr.getParam('bookId'); \n    this.bookService.getBook(id).subscribe(book => {\n      console.log(\"got book obs\");\n      this.book = book;\n      if (this.book !== null)\n        this.book.id = id;\n      console.log(\"set owner\");\n      book === null ? this.owner = null : this.userService.getUser(book.owner).subscribe(user => this.owner = user);\n    });\n  }\n  \n  getAuthors(book:Book):string {\n    console.log(\"get authors\");\n    if (!book)\n      return \"\";\n    if (!book.authors)\n      return \"Unknown authors\";\n    return book.authors.reduce((prev, current) => prev + \", \" + current);\n  }\n  \n  private makeTradeRequest(book:Book) {\n    console.log(\"make trade\")\n    let request:TradeRequest = {\n        bookId: this.book.id,\n        ownerId: this.owner.id,\n        requesterId: this.user.id,\n        status: 'new'\n      };\n    this.bookService.addTradeRequest(request);\n    alert(\"Added trade request for book \" + book.title);\n  }\n\n}\n"]}